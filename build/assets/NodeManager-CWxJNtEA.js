import{j as e}from"./markdown-Bat84yML.js";import{r as s,T as J,X as Q,c as z,V as me,u as U,y as ke,O as st,a0 as ue,a1 as rt,a2 as ot}from"./lucide-Bfyd0ICn.js";import{x as at,a as nt}from"./xterm-B1V9QH9F.js";import{u as it}from"./index-BOUrY8QV.js";import{R as lt}from"./RestrictedView-Cn5sOcE9.js";import"./react-vendor-N--QU9DW.js";const dt=({isOpen:r,onClose:b,title:c="System Terminal",onMount:u,socketUrl:a})=>{const p=s.useRef(null),n=s.useRef(null),x=s.useRef(null),l=s.useRef(null);return s.useEffect(()=>{if(!r||!p.current)return;if(!n.current)if(n.current=new at.Terminal({cursorBlink:!0,background:"#000000",foreground:"#ffffff",fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace",fontSize:13,theme:{background:"#000000",foreground:"#ffffff",cursor:"#7C3AED",selectionBackground:"rgba(124, 58, 237, 0.3)",black:"#000000",red:"#ef4444",green:"#22c55e",yellow:"#eab308",blue:"#3b82f6",magenta:"#a855f7",cyan:"#06b6d4",white:"#ffffff",brightBlack:"#737373",brightRed:"#f87171",brightGreen:"#4ade80",brightYellow:"#facc15",brightBlue:"#60a5fa",brightMagenta:"#c084fc",brightCyan:"#22d3ee",brightWhite:"#ffffff"},allowTransparency:!0,scrollback:5e3,disableStdin:!a}),x.current=new nt.FitAddon,n.current.loadAddon(x.current),n.current.open(p.current),x.current.fit(),u&&u(n.current),a){const d=new WebSocket(a);l.current=d,d.onopen=()=>{n.current.writeln("\x1B[36m> Connecting to remote terminal...\x1B[0m"),d.send(JSON.stringify({type:"resize",cols:n.current.cols,rows:n.current.rows}))},d.onmessage=f=>{try{const g=JSON.parse(f.data);g.type==="output"&&g.data?n.current.write(g.data):g.type==="error"&&n.current.writeln(`\r
\x1B[31mError: ${g.message}\x1B[0m`)}catch{n.current.write(f.data)}},d.onclose=()=>{n.current.writeln(`\r
\x1B[33m> Disconnected.\x1B[0m`)},d.onerror=()=>{n.current.writeln(`\r
\x1B[31m> Connection error.\x1B[0m`)},n.current.onData(f=>{d.readyState===WebSocket.OPEN&&d.send(JSON.stringify({type:"input",data:f}))}),n.current.onResize(f=>{d.readyState===WebSocket.OPEN&&d.send(JSON.stringify({type:"resize",cols:f.cols,rows:f.rows}))})}else n.current.writeln("\x1B[38;2;124;58;237m> Initializing connection interface...\x1B[0m");const N=()=>{x.current&&x.current.fit()};return window.addEventListener("resize",N),()=>{window.removeEventListener("resize",N),l.current&&(l.current.close(),l.current=null),n.current&&(n.current.dispose(),n.current=null)}},[r,a]),r?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-void-panel border border-void-border rounded-xl w-full max-w-4xl overflow-hidden shadow-2xl flex flex-col max-h-[80vh]",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-void-border bg-void-panel-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-void-purple"}),e.jsx("h3",{className:"text-lg font-bold text-white",children:c})]}),e.jsx("button",{onClick:b,className:"p-1 hover:bg-white/10 rounded-md transition-colors text-void-muted hover:text-white",children:e.jsx(Q,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex-1 bg-black p-4 min-h-[400px]",children:e.jsx("div",{ref:p,className:"h-full w-full"})})]})}):null},yt=({cloudUser:r})=>{const b=it(),[c,u]=s.useState([]),[a,p]=s.useState(null),[n,x]=s.useState(!1),[l,N]=s.useState(null),[d,f]=s.useState(!1),[g,O]=s.useState(!1),[h,Y]=s.useState(null),[G,W]=s.useState(!1),[F,C]=s.useState(!1),[j,K]=s.useState(null),[be,R]=s.useState(null),[A,pe]=s.useState(!1),[P,_]=s.useState(!1),[S,i]=s.useState(null),[v,w]=s.useState(!1),[Z,q]=s.useState(null),[ee,D]=s.useState(null),[T,bt]=s.useState(!1),[E,Ce]=s.useState(null),[pt,ht]=s.useState(null),[he,ve]=s.useState(!1),[te,$]=s.useState(null),[se,Ae]=s.useState(""),[L,re]=s.useState("all"),[M,fe]=s.useState(!1),[Pe,oe]=s.useState(!1),[Ie,ae]=s.useState(null),[Re,V]=s.useState(!1),[Te,ne]=s.useState("Installation Terminal"),[Ee,ge]=s.useState(null),y=s.useRef(null),Fe=s.useMemo(()=>{if(!r)return!1;if(r.is_restricted)return!0;try{const t=typeof r.restricted_features=="string"?JSON.parse(r.restricted_features):r.restricted_features;if(Array.isArray(t)&&t.includes("manage_nodes"))return!0}catch{}return!1},[r]);s.useEffect(()=>{m(),k(),B(),X(),ie(),we()},[]),s.useEffect(()=>{const t=()=>{m(),k()};return window.addEventListener("void-active-account-changed",t),()=>{window.removeEventListener("void-active-account-changed",t)}},[]),s.useEffect(()=>{if(!n)return;const t=setInterval(()=>{m(),k()},3e3);return()=>clearInterval(t)},[n]);const _e=s.useMemo(()=>{const t=String(se||"").trim().toLowerCase();return(Array.isArray(c)?c:[]).filter(o=>{if(!(L==="all"?!0:String(o?.status)===L))return!1;if(!t)return!0;const H=String(o?.name||"").toLowerCase(),ye=String(o?.ip_address||"").toLowerCase(),ce=String(o?.port||"").toLowerCase();return H.includes(t)||ye.includes(t)||ce.includes(t)})},[c,se,L]),m=async()=>{try{const t=await window.electronAPI.getNodes();if(t?.error)throw new Error(t.error);u(t)}catch(t){console.error("Failed to fetch nodes:",t),$({type:"error",message:t.message||"Failed to fetch nodes"})}},k=async()=>{try{const t=await window.electronAPI.getNodeHealthSummary();if(t?.error)throw new Error(t.error);if(!t?.summary)throw new Error("Invalid health summary response");p(t)}catch(t){console.error("Failed to fetch health summary:",t)}},B=async()=>{try{const t=await window.electronAPI.getSyncStatus();if(t?.error)throw new Error(t.error);if(!t?.summary||!Array.isArray(t?.nodes))throw new Error("Invalid sync status response");Y(t)}catch(t){console.error("Failed to fetch sync status:",t)}},X=async()=>{try{const t=await window.electronAPI.getLoadAnalysis();if(t?.error)throw new Error(t.error);if(!Array.isArray(t?.nodes)||!Array.isArray(t?.unassigned_servers))throw new Error("Invalid load analysis response");K(t)}catch(t){console.error("Failed to fetch load analysis:",t)}},ie=async()=>{try{const t=await window.electronAPI.getFailoverStatus();if(t?.error)throw new Error(t.error);if(!t?.stats||!Array.isArray(t?.failed_nodes))throw new Error("Invalid failover status response");i(t)}catch(t){console.error("Failed to fetch failover status:",t)}},we=async()=>{try{const t=await window.electronAPI.getResourceStatus();if(t?.error)throw new Error(t.error);if(!t?.summary?.averages||!t?.summary?.alerts||!Array.isArray(t?.nodes))throw new Error("Invalid resource status response");Ce(t)}catch(t){console.error("Failed to fetch resource status:",t)}},Ne=async()=>{f(!0);try{await window.electronAPI.discoverNodes(),await m(),await k()}catch(t){console.error("Failed to discover nodes:",t)}finally{f(!1)}},$e=async()=>{O(!0);try{await window.electronAPI.checkAllNodesHealth(),await m(),await k()}catch(t){console.error("Failed to check nodes health:",t)}finally{O(!1)}},Le=async t=>{try{await window.electronAPI.createNode(t),x(!1),m(),k(),$({type:"success",message:"Node added"})}catch(o){console.error("Failed to create node:",o),$({type:"error",message:o.message||"Failed to create node"})}},Me=async t=>{if(await b.confirm("Are you sure you want to delete this node? This will not affect servers on the node."))try{await window.electronAPI.deleteNode(t),m(),k()}catch(o){console.error("Failed to delete node:",o)}},Be=async t=>{try{await window.electronAPI.forceNodeHealthCheck(t),await m(),await k()}catch(o){console.error("Failed to check node health:",o)}},Oe=async()=>{W(!0);try{await window.electronAPI.syncAllNodes(),await m(),await B()}catch(t){console.error("Failed to sync all nodes:",t)}finally{W(!1)}},De=async t=>{try{await window.electronAPI.syncNode(t),await m(),await B()}catch(o){console.error("Failed to sync node:",o)}},He=async()=>{C(!0);try{await window.electronAPI.rebalanceServers(),await m(),await B(),await X()}catch(t){console.error("Failed to rebalance servers:",t)}finally{C(!1)}},Ue=async(t="resource_based")=>{_(!0);try{await window.electronAPI.executeLoadBalancing(t),await m(),await B(),await X()}catch(o){console.error("Failed to execute load balancing:",o)}finally{_(!1)}},ze=async()=>{_(!0);try{await window.electronAPI.autoBalanceLoad(),await m(),await B(),await X()}catch(t){console.error("Failed to auto-balance:",t)}finally{_(!1)}},Je=async()=>{w(!0);try{await window.electronAPI.checkFailover(),await m(),await ie()}catch(t){console.error("Failed to check failover:",t)}finally{w(!1)}},Ge=async t=>{try{await window.electronAPI.recoverNode(t),await m(),await ie()}catch(o){console.error("Failed to recover node:",o)}},We=async t=>{try{const o=await window.electronAPI.getRemoteNodeStatus(t);q(o),D(t)}catch(o){console.error("Failed to get remote status:",o)}},le=async(t,o)=>{if(o.length===0){b.alert("Please select at least one node");return}try{const I=await window.electronAPI.executeBulkOperation(t,o);console.log("Bulk operation result:",I),await m(),await k()}catch(I){console.error("Failed to execute bulk operation:",I)}},Ke=async()=>{ve(!0);try{await window.electronAPI.collectResources(),await we()}catch(t){console.error("Failed to collect resources:",t)}finally{ve(!1)}},de=s.useMemo(()=>c.find(t=>t.is_local),[c]),je=async()=>{fe(!0);try{if(de)await b.confirm("Disable this PC as a node? It will go offline and servers will stop.")&&(await window.electronAPI.disableLocalNode(),$({type:"success",message:"Local node disabled"}));else{const t=await window.electronAPI.enableLocalNode({name:"My PC",port:3001,startTunnel:!0});$({type:"success",message:"This PC is now a hostable node!"}),t.tunnel&&(ae(t.tunnel),oe(!0))}await m()}catch(t){console.error("Failed to toggle local node:",t),$({type:"error",message:t.message||"Failed to toggle local node"})}finally{fe(!1)}},qe=async t=>{try{const o=await window.electronAPI.getNodeTunnelStatus(t);ae(o),oe(!0)}catch(o){console.error("Failed to get tunnel status:",o)}},Ve=t=>{const o=window.location.protocol==="https:"?"wss:":"ws:",I=window.electronAPI?.config?.backendPort||"3456",H=`${o}//localhost:${I}/api/servers/terminal?nodeId=${t.id}`;ne(`Terminal: ${t.name}`),ge(H),V(!0)},Xe=async t=>{x(!1),ne(t.connectionString?`Installing via Raw SSH: ${t.connectionString.substring(0,20)}...`:`Installing Node at ${t.ipAddress}...`),V(!0),await new Promise(o=>setTimeout(o,100));try{y.current&&(y.current.clear(),y.current.writeln("\x1B[36m> Initiating direct installation connection...\x1B[0m"));const I=`http://localhost:${window.electronAPI?.config?.backendPort||3456}/api/nodes/install`,H=localStorage.getItem("turbonox_token"),ce=(await fetch(I,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${H}`},body:JSON.stringify(t)})).body.getReader(),Qe=new TextDecoder;for(;;){const{done:Ye,value:Ze}=await ce.read();if(Ye)break;const et=Qe.decode(Ze,{stream:!0});if(y.current){const Se=et.split(`
`);Se.forEach((xe,tt)=>{tt<Se.length-1||xe.endsWith(`
`)?y.current.writeln(xe.trimEnd()):y.current.write(xe)})}}y.current&&y.current.writeln(`
\x1B[32m> Process finish. You can close this window now.\x1B[0m`),setTimeout(()=>{m()},2e3)}catch(o){y.current&&y.current.writeln(`
\x1B[31m> Error: ${o.message}\x1B[0m`)}};return Fe?e.jsx(lt,{title:"Node Management Restricted",description:"Access to node discovery, health monitoring, and distributed management has been restricted for your account."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-void-text",children:"Node Manager"}),e.jsx("p",{className:"text-void-muted mt-1",children:"Manage your multi-node Turbonox network"})]}),e.jsxs("div",{className:"flex flex-wrap justify-end gap-2",children:[e.jsxs("button",{onClick:je,disabled:M,className:`px-4 py-2 rounded-md text-sm font-semibold transition-colors flex items-center gap-2 border ${de?"bg-red-500/10 hover:bg-red-500/20 border-red-500/20 text-red-200":"bg-emerald-500/10 hover:bg-emerald-500/20 border-emerald-500/20 text-emerald-200"}`,children:[e.jsx(z,{className:`w-4 h-4 ${M?"animate-pulse":""}`}),M?"Processing...":de?"Disable My PC":"Turn PC into Node"]}),e.jsxs("div",{className:"hidden md:flex items-center gap-2 px-3 py-2 bg-void-panel-2 border border-void-border rounded-md",children:[e.jsx(me,{className:"w-4 h-4 text-void-muted"}),e.jsx("input",{value:se,onChange:t=>Ae(t.target.value),placeholder:"Search nodes...",className:"bg-transparent outline-none text-sm text-void-text placeholder:text-void-muted w-48"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>re("all"),className:`px-3 py-2 rounded-md border text-sm font-medium transition-colors ${L==="all"?"bg-void-panel-2 border-void-border text-void-text":"bg-void-panel-2 hover:bg-void-panel-2 border-void-border text-void-muted"}`,children:"All"}),e.jsx("button",{onClick:()=>re("online"),className:`px-3 py-2 rounded-md border text-sm font-medium transition-colors ${L==="online"?"bg-emerald-500/10 border-emerald-500/20 text-emerald-200":"bg-void-panel-2 hover:bg-void-panel-2 border-void-border text-void-muted"}`,children:"Online"}),e.jsx("button",{onClick:()=>re("offline"),className:`px-3 py-2 rounded-md border text-sm font-medium transition-colors ${L==="offline"?"bg-red-500/10 border-red-500/20 text-red-200":"bg-void-panel-2 hover:bg-void-panel-2 border-void-border text-void-muted"}`,children:"Offline"})]}),e.jsxs("button",{onClick:Ne,disabled:d,className:"px-3 py-2 bg-void-panel-2 hover:bg-void-panel-2 border border-void-border text-void-text rounded-md text-sm font-medium transition-colors disabled:opacity-50 flex items-center gap-2",children:[e.jsx(me,{className:`w-4 h-4 ${d?"animate-spin":""}`}),d?"Discovering...":"Discover Nodes"]}),e.jsxs("button",{onClick:$e,disabled:g,className:"px-3 py-2 bg-void-panel-2 hover:bg-void-panel-2 border border-void-border text-void-text rounded-md text-sm font-medium transition-colors disabled:opacity-50 flex items-center gap-2",children:[e.jsx(U,{className:`w-4 h-4 ${g?"animate-spin":""}`}),g?"Checking...":"Check Health"]}),e.jsxs("button",{onClick:Oe,disabled:G,className:"px-3 py-2 bg-void-panel-2 hover:bg-void-panel-2 border border-void-border text-void-text rounded-md text-sm font-medium transition-colors disabled:opacity-50 flex items-center gap-2",children:[e.jsx(U,{className:`w-4 h-4 ${G?"animate-spin":""}`}),G?"Syncing...":"Sync All"]}),e.jsxs("button",{onClick:He,disabled:F,className:"px-3 py-2 bg-void-panel-2 hover:bg-void-panel-2 border border-void-border text-void-text rounded-md text-sm font-medium transition-colors disabled:opacity-50 flex items-center gap-2",children:[e.jsx(U,{className:`w-4 h-4 ${F?"animate-spin":""}`}),F?"Rebalancing...":"Rebalance"]}),e.jsxs("button",{onClick:()=>x(!0),className:"px-4 py-2 bg-void-cyan/15 hover:bg-void-cyan/20 border border-void-cyan/20 text-void-text rounded-md text-sm font-semibold transition-colors flex items-center gap-2",children:[e.jsx(ke,{className:"w-4 h-4"}),"Add Node"]})]})]}),e.jsxs("div",{className:"rounded-none border border-purple-500/20 bg-purple-500/5 p-4 flex items-center gap-3",children:[e.jsx(st,{className:"w-5 h-5 text-purple-400"}),e.jsxs("div",{className:"text-sm text-purple-200 font-mono tracking-wide",children:[e.jsx("span",{className:"font-bold text-purple-400",children:"BETA WARNING //"})," NODES ARE EXPERIMENTAL. USE AT YOUR OWN RISK."]})]}),te?e.jsx("div",{className:`rounded-none border p-4 ${te.type==="success"?"text-purple-400 border-purple-500/50 bg-purple-500/5":"text-void-text border-void-border bg-void-panel-2"}`,children:e.jsx("div",{className:"text-sm font-mono tracking-wide",children:te.message})}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 border border-void-border bg-void-bg text-sm",children:[e.jsxs("div",{className:"p-4 border-r border-b md:border-b-0 border-void-border flex flex-col justify-between h-32",children:[e.jsx("div",{className:"text-void-muted font-mono text-xs uppercase tracking-wider mb-2",children:"Network Status"}),a&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("span",{className:"text-void-muted",children:"Total Nodes"}),e.jsx("span",{className:"text-xl font-bold font-mono text-white",children:a.summary.total})]}),e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("span",{className:"text-void-muted",children:"Online"}),e.jsx("span",{className:"text-xl font-bold font-mono text-purple-400",children:a.summary.online})]}),e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("span",{className:"text-void-muted",children:"Offline"}),e.jsx("span",{className:"text-xl font-bold font-mono text-void-muted",children:a.summary.offline})]})]})]}),e.jsxs("div",{className:"p-4 border-r border-b md:border-b-0 border-void-border flex flex-col justify-between h-32",children:[e.jsx("div",{className:"text-void-muted font-mono text-xs uppercase tracking-wider mb-2",children:"Sync Status"}),h&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("span",{className:"text-void-muted",children:"Sync Rate"}),e.jsxs("span",{className:"text-xl font-bold font-mono text-white",children:[h.summary.sync_percentage,"%"]})]}),e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("span",{className:"text-void-muted",children:"Unassigned"}),e.jsx("span",{className:"text-xl font-bold font-mono text-void-muted",children:h.summary.total_servers-h.summary.assigned_servers})]}),e.jsx("div",{className:"w-full bg-void-border h-1 mt-2",children:e.jsx("div",{className:"bg-purple-500 h-full",style:{width:`${h.summary.sync_percentage}%`}})})]})]}),e.jsxs("div",{className:"p-4 border-r border-b md:border-b-0 border-void-border flex flex-col justify-between h-32",children:[e.jsx("div",{className:"text-void-muted font-mono text-xs uppercase tracking-wider mb-2",children:"Load Distribution"}),j&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("span",{className:"text-void-muted",children:"Avg Load"}),e.jsxs("span",{className:"text-xl font-bold font-mono text-white",children:[j.average_load.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("span",{className:"text-void-muted",children:"Active Nodes"}),e.jsx("span",{className:"text-xl font-bold font-mono text-white",children:j.nodes.length})]})]}),e.jsxs("div",{className:"flex gap-1 mt-2",children:[e.jsx("button",{onClick:()=>Ue("resource_based"),disabled:P,className:"px-2 py-1 bg-void-panel hover:bg-void-panel-2 border border-void-border text-[10px] text-void-text uppercase transition-colors",children:"Resource"}),e.jsx("button",{onClick:ze,disabled:P,className:"px-2 py-1 bg-void-panel hover:bg-void-panel-2 border border-void-border text-[10px] text-void-text uppercase transition-colors",children:"Auto"})]})]}),e.jsxs("div",{className:"p-4 border-void-border flex flex-col justify-between h-32",children:[e.jsx("div",{className:"text-void-muted font-mono text-xs uppercase tracking-wider mb-2",children:"Failover Shield"}),S&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("span",{className:"text-void-muted",children:"Events"}),e.jsx("span",{className:"text-xl font-bold font-mono text-white",children:S.stats.failed_nodes_count})]}),e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("span",{className:"text-void-muted",children:"Rescued"}),e.jsx("span",{className:"text-xl font-bold font-mono text-purple-400",children:S.stats.successful_failovers})]})]}),e.jsx("button",{onClick:Je,disabled:v,className:"mt-2 w-full py-1 bg-void-panel hover:bg-void-panel-2 border border-void-border text-[10px] text-void-text uppercase transition-colors flex justify-center items-center gap-2",children:v?"Scanning...":"Scan Network"})]})]}),S&&S.failed_nodes&&S.failed_nodes.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-md font-bold text-void-text mb-2",children:"Failed Nodes"}),e.jsx("div",{className:"space-y-2",children:S.failed_nodes.map(t=>e.jsxs("div",{className:"bg-red-400/10 border border-red-400/20 rounded-lg p-3 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-void-text font-medium",children:t.name}),e.jsxs("span",{className:"text-void-muted text-sm ml-2",children:["(",t.ip_address,")"]})]}),e.jsx("button",{onClick:()=>Ge(t.id),className:"px-3 py-1 bg-purple-500/15 hover:bg-purple-500/20 border border-purple-500/20 text-void-text text-sm transition-colors",children:"Recover"})]},t.id))})]}),e.jsxs("div",{className:"bg-black border border-void-border p-6 mt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-void-text mb-4 font-mono tracking-wide uppercase",children:"Remote Management"}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("button",{onClick:()=>le("get_stats",c.filter(t=>t.status==="online").map(t=>t.id)),className:"px-4 py-2 bg-void-panel hover:bg-void-panel-2 border border-void-border text-void-text text-sm transition-colors font-mono uppercase tracking-wider",children:"Collect All Stats"}),e.jsx("button",{onClick:()=>le("start_all_servers",c.filter(t=>t.status==="online").map(t=>t.id)),className:"px-4 py-2 bg-void-panel hover:bg-void-panel-2 border border-void-border text-void-text text-sm transition-colors font-mono uppercase tracking-wider",children:"Start All Servers"}),e.jsx("button",{onClick:()=>le("stop_all_servers",c.filter(t=>t.status==="online").map(t=>t.id)),className:"px-4 py-2 bg-void-panel hover:bg-void-panel-2 border border-void-border text-void-text text-sm transition-colors font-mono uppercase tracking-wider",children:"Stop All Servers"})]})]}),E&&e.jsxs("div",{className:"bg-black border border-void-border p-6 mt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-void-text mb-4 font-mono tracking-wide uppercase",children:"Resource Monitoring"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center p-4 border border-void-border",children:[e.jsxs("div",{className:"text-2xl font-bold text-white font-mono",children:[E.summary.averages.cpu_usage.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-void-muted uppercase tracking-wider mt-1",children:"Avg CPU"})]}),e.jsxs("div",{className:"text-center p-4 border border-void-border",children:[e.jsxs("div",{className:"text-2xl font-bold text-white font-mono",children:[E.summary.averages.memory_usage.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-void-muted uppercase tracking-wider mt-1",children:"Avg Memory"})]}),e.jsxs("div",{className:"text-center p-4 border border-void-border",children:[e.jsx("div",{className:"text-2xl font-bold text-white font-mono",children:E.summary.alerts.critical}),e.jsx("div",{className:"text-xs text-void-muted uppercase tracking-wider mt-1",children:"Critical"})]}),e.jsxs("div",{className:"text-center p-4 border border-void-border",children:[e.jsx("div",{className:"text-2xl font-bold text-white font-mono",children:E.summary.alerts.warning}),e.jsx("div",{className:"text-xs text-void-muted uppercase tracking-wider mt-1",children:"Warning"})]})]}),e.jsx("div",{className:"flex gap-3",children:e.jsx("button",{onClick:Ke,disabled:he,className:"px-4 py-2 bg-void-panel hover:bg-void-panel-2 border border-void-border text-void-text text-sm transition-colors disabled:opacity-50 font-mono uppercase tracking-wider",children:he?"Scanning...":"Scan Resources"})}),E.nodes.some(t=>t.alerts&&t.alerts.length>0)&&e.jsxs("div",{className:"mt-6 border-t border-void-border pt-4",children:[e.jsx("h4",{className:"text-xs font-bold text-void-muted mb-2 uppercase tracking-wider",children:"System Alerts"}),e.jsx("div",{className:"space-y-1 max-h-40 overflow-y-auto",children:E.nodes.filter(t=>t.alerts&&t.alerts.length>0).flatMap(t=>t.alerts.map(o=>({...o,node_name:t.node.name}))).slice(0,10).map((t,o)=>e.jsxs("div",{className:"p-2 border border-void-border flex justify-between items-center text-sm",children:[e.jsxs("div",{className:"font-mono text-void-text",children:[e.jsxs("span",{className:"text-void-muted mr-2",children:["[",t.node_name,"]"]}),t.metric.toUpperCase()]}),e.jsx("div",{className:"text-xs text-void-muted",children:t.message})]},o))})]})]}),c.length===0?e.jsxs("div",{className:"bg-black border border-void-border p-16 text-center",children:[e.jsx("div",{className:"w-16 h-16 border border-void-border bg-void-panel mx-auto mb-6 flex items-center justify-center",children:e.jsx(z,{className:"w-8 h-8 text-void-muted"})}),e.jsx("h3",{className:"text-xl font-bold text-void-text mb-2 tracking-wide font-mono uppercase",children:"System Offline"}),e.jsx("p",{className:"text-void-muted max-w-md mx-auto text-sm mb-10",children:"No nodes detected. Initialize the first node to begin scaling."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[e.jsxs("button",{onClick:()=>x(!0),className:"px-8 py-3 bg-purple-600 hover:bg-purple-700 text-white font-mono text-sm font-bold transition-all border border-transparent hover:border-purple-400 flex items-center gap-2",children:[e.jsx(ke,{className:"w-4 h-4"}),e.jsx("span",{children:"Initialize Node"})]}),e.jsxs("button",{onClick:je,disabled:M,className:"px-8 py-3 bg-transparent hover:bg-void-panel border border-void-border text-void-text font-mono text-sm font-bold transition-all flex items-center gap-2 disabled:opacity-50",children:[e.jsx(z,{className:`w-4 h-4 ${M?"animate-pulse":""}`}),e.jsx("span",{children:M?"Initializing...":"Use This Device"})]}),e.jsxs("button",{onClick:Ne,disabled:d,className:"px-8 py-3 bg-transparent hover:bg-void-panel border border-void-border text-void-text font-mono text-sm font-bold transition-all flex items-center gap-2 disabled:opacity-50",children:[e.jsx(me,{className:`w-4 h-4 ${d?"animate-spin":""}`}),e.jsx("span",{children:d?"Scanning...":"Scan Network"})]})]}),e.jsx("div",{className:"mt-8 pt-8 border-t border-void-border max-w-sm mx-auto",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx(ue,{className:"w-4 h-4 text-void-muted mx-auto mb-2"}),e.jsx("div",{className:"text-[10px] text-void-muted uppercase tracking-wider",children:"Distributed"})]}),e.jsxs("div",{children:[e.jsx(U,{className:"w-4 h-4 text-void-muted mx-auto mb-2"}),e.jsx("div",{className:"text-[10px] text-void-muted uppercase tracking-wider",children:"Balanced"})]}),e.jsxs("div",{children:[e.jsx(J,{className:"w-4 h-4 text-void-muted mx-auto mb-2"}),e.jsx("div",{className:"text-[10px] text-void-muted uppercase tracking-wider",children:"Controlled"})]})]})})]}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:_e.map(t=>e.jsx(ct,{node:t,onDelete:()=>Me(t.id),onHealthCheck:()=>Be(t.id),onSync:()=>De(t.id),onRemoteControl:()=>We(t.id),onViewDetails:()=>N(t),onManageTunnel:()=>qe(t.id),onOpenTerminal:()=>Ve(t)},t.id))}),n&&e.jsx(xt,{onClose:()=>x(!1),onCreate:Le,onInstall:Xe,onOpenRawTerminal:(t,o)=>{ge(t),ne(o),V(!0)}}),e.jsx(dt,{isOpen:Re,onClose:()=>V(!1),title:Te,socketUrl:Ee,onMount:t=>{y.current=t}}),l&&e.jsx(mt,{node:l,onClose:()=>N(null)}),Pe&&e.jsx(ut,{status:Ie,onClose:()=>oe(!1),onUpdate:ae})]})},ct=({node:r,onDelete:b,onHealthCheck:c,onViewDetails:u,onSync:a,onRemoteControl:p,onManageTunnel:n,onOpenTerminal:x})=>{const l=N=>{switch(N){case"online":return e.jsx("div",{className:"w-2 h-2 rounded-sm bg-purple-500 shadow-[0_0_8px_rgba(124,58,237,0.5)] animate-pulse"});case"offline":return e.jsx("div",{className:"w-2 h-2 rounded-sm bg-void-border"});default:return e.jsx("div",{className:"w-2 h-2 rounded-sm bg-void-border animate-pulse"})}};return e.jsxs("div",{className:"group relative bg-black hover:bg-void-panel-2 transition-colors border border-void-border p-5",children:[r.status==="online"&&e.jsx("div",{className:"absolute inset-0 border border-purple-500/10 pointer-events-none"}),e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-10 h-10 flex items-center justify-center border ${r.status==="online"?"border-purple-500/30 bg-purple-500/5":"border-void-border bg-void-panel-2"}`,children:e.jsx(z,{className:`w-5 h-5 ${r.status==="online"?"text-purple-400":"text-void-muted"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-base font-bold text-void-text tracking-wide font-mono",children:r.name}),l(r.status)]}),e.jsxs("p",{className:"text-xs text-void-muted font-mono",children:[r.ip_address,":",r.port||3001]})]})]}),e.jsxs("div",{className:"flex gap-1 opacity-100 transition-opacity",children:[e.jsx("button",{onClick:c,className:"p-2 hover:bg-void-bg border border-transparent hover:border-void-border text-void-muted hover:text-void-text transition-all",title:"Health Check",children:e.jsx(U,{className:"w-4 h-4"})}),e.jsx("button",{onClick:x,className:"p-2 hover:bg-void-bg border border-transparent hover:border-void-border text-void-muted hover:text-purple-400 transition-all",title:"SSH Terminal",children:e.jsx(J,{className:"w-4 h-4"})}),e.jsx("button",{onClick:b,className:"p-2 hover:bg-void-bg border border-transparent hover:border-void-border text-void-muted hover:text-red-400 transition-all",title:"Delete Node",children:e.jsx(Q,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6 border-t border-b border-void-border/50 py-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] uppercase tracking-widest text-void-muted mb-1",children:"Last Seen"}),e.jsx("div",{className:"text-sm text-void-text font-mono",children:r.last_seen?new Date(r.last_seen).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--:--"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] uppercase tracking-widest text-void-muted mb-1",children:"Type"}),e.jsx("div",{className:"text-sm text-void-text font-mono",children:(()=>{try{return(r.capabilities?JSON.parse(r.capabilities):null)?.agent?"AGENT":"MANUAL"}catch{return"MANUAL"}})()})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:u,className:"flex-1 py-2 bg-void-panel hover:bg-void-panel-2 border border-void-border text-void-text text-xs uppercase tracking-wider font-semibold transition-colors",children:"Details"}),e.jsx("button",{onClick:()=>a(r.id),className:"flex-1 py-2 bg-void-panel hover:bg-void-panel-2 border border-void-border text-void-text text-xs uppercase tracking-wider font-semibold transition-colors",children:"Sync"})]})]})},xt=({onClose:r,onCreate:b,onInstall:c,onOpenRawTerminal:u})=>{const[a,p]=s.useState({name:"",ipAddress:"",port:3001,connectionType:"http",sshUser:"",sshPassword:"",sshKey:"",sshPort:22}),[n,x]=s.useState("direct"),[l,N]=s.useState(!1),[d,f]=s.useState(null),[g,O]=s.useState(!1),[h,Y]=s.useState(""),[G,W]=s.useState(null),[F,C]=s.useState(""),[j,K]=s.useState(""),be=i=>{if(!i)return;let v="",w="",Z=22;const q=i.replace(/^ssh\s+/,"").trim(),ee=q.match(/-p\s+(\d+)/);ee&&(Z=parseInt(ee[1]));const D=q.replace(/-p\s+\d+/,"").replace(/-[a-zA-Z]/g,"").trim();if(D.includes("@")){const T=D.split("@");v=T[0],w=T[1]}else w=D;w&&(p(T=>({...T,connectionType:"ssh",sshUser:v||T.sshUser,ipAddress:w,sshPort:Z,name:T.name||w})),K(""))},R=s.useMemo(()=>{const i=Number(a.port);return Number.isFinite(i)?i<1?1:i>65535?65535:Math.floor(i):3001},[a.port]),A=s.useMemo(()=>`http://localhost:${window.electronAPI?.config?.backendPort||"3456"}`,[]),pe=s.useMemo(()=>h?`curl -fsSL "${A}/api/nodes/bootstrap/linux" | TURBONOX_MASTER_URL="${A}" TURBONOX_JOIN_CODE="${h}" TURBONOX_NODE_PORT="${R}" bash`:"",[h,A,R]);s.useMemo(()=>h?`powershell -ExecutionPolicy Bypass -Command "$p=Join-Path $env:TEMP 'turbonox-bootstrap-node-agent.ps1'; iwr -UseBasicParsing '${A}/api/nodes/bootstrap/windows' -OutFile $p; & $p -MasterUrl '${A}' -JoinCode '${h}' -Port ${R} -Name '${a.name||"VPS"}'"`:"",[h,A,R,a.name]);const P=(i,v)=>{p(w=>({...w,[i]:v}))},_=async()=>{O(!0),C("");try{const v=await(await fetch(`${A}/api/nodes/join-code`,{method:"POST"})).json();if(v.error)throw new Error(v.error);Y(v.join_code),W(v.expires_in_ms)}catch(i){C("Failed to generate code: "+i.message)}finally{O(!1)}},S=async()=>{if(n==="direct"){if(!a.name?.trim())return C("Node Name is required");if(!a.ipAddress?.trim())return C("IP Address is required");const i={...a,port:R};b(i)}else r()};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-void-panel border border-void-border rounded-xl w-full max-w-4xl overflow-hidden shadow-2xl flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-void-border bg-void-panel-2",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Add New Node"}),e.jsx("button",{onClick:r,className:"p-1 hover:bg-white/10 rounded-md transition-colors text-void-muted hover:text-white",children:e.jsx(Q,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex border-b border-void-border",children:[e.jsx("button",{onClick:()=>x("direct"),className:`flex-1 py-4 text-xs uppercase tracking-wider font-bold border-b transition-colors ${n==="direct"?"border-purple-500 text-purple-400 bg-purple-500/5":"border-transparent text-void-muted hover:text-void-text hover:bg-white/5"}`,children:"Direct Connection / SSH"}),e.jsx("button",{onClick:()=>x("bootstrap"),className:`flex-1 py-4 text-xs uppercase tracking-wider font-bold border-b transition-colors ${n==="bootstrap"?"border-purple-500 text-purple-400 bg-purple-500/5":"border-transparent text-void-muted hover:text-void-text hover:bg-white/5"}`,children:"Agent Bootstrap Script"})]}),e.jsxs("form",{onSubmit:i=>{i.preventDefault()},className:"p-6 flex-1 overflow-y-auto space-y-8",children:[n==="direct"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-void-panel-2 border border-void-border rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-void-muted mb-2",children:"Connection Type"}),e.jsxs("select",{value:a.connectionType,onChange:i=>P("connectionType",i.target.value),className:"w-full px-4 py-3 bg-void-panel border border-void-border rounded-lg text-void-text focus:outline-none focus:ring-2 focus:ring-void-cyan/50",children:[e.jsx("option",{value:"http",children:"HTTP (Agent)"}),e.jsx("option",{value:"ssh",children:"SSH (Direct)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-void-muted mb-2",children:"Node Name"}),e.jsx("input",{type:"text",value:a.name,onChange:i=>p({...a,name:i.target.value}),className:"w-full px-4 py-3 bg-void-panel border border-void-border rounded-lg text-void-text placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-void-cyan/50",placeholder:"My Server",required:!0})]})]})}),e.jsx("div",{className:"bg-void-panel-2 border border-void-border rounded-lg p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-void-text uppercase tracking-wider",children:"SSH Configuration"}),e.jsx("div",{className:"text-xs text-void-muted italic",children:"Paste connection string to auto-fill"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-void-muted mb-1.5 uppercase tracking-wider",children:"Quick Paste (e.g. ssh user@host)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:j,onChange:i=>K(i.target.value),className:"flex-1 px-3 py-2 bg-void-panel-2 border border-void-border rounded-lg text-void-text text-sm focus:outline-none focus:ring-1 focus:ring-purple-500/50 dashboard-no-drag",placeholder:"Paste SSH command here..."}),e.jsx("button",{type:"button",onClick:()=>be(j),className:"px-3 py-2 bg-void-panel-2 hover:bg-void-panel border border-void-border text-void-text text-xs rounded-lg transition-colors",children:"Parse"}),e.jsx("button",{type:"button",onClick:()=>{if(!j)return;const i=window.location.protocol==="https:"?"wss:":"ws:",v=window.electronAPI?.config?.backendPort||"3456",w=`${i}//localhost:${v}/api/servers/terminal?connectionString=${encodeURIComponent(j)}`;u(w,`SSH: ${j.substring(0,30)}...`)},className:"px-3 py-2 bg-void-purple/15 hover:bg-void-purple/20 border border-void-purple/20 text-void-text text-xs rounded-lg transition-colors flex items-center gap-2",title:"Run interactive SSH command directly",children:e.jsx(J,{className:"w-4 h-4"})}),e.jsxs("button",{type:"button",onClick:()=>{j&&c({connectionString:j,name:a.name||"Quick Node"})},className:"px-3 py-2 bg-purple-500/15 hover:bg-purple-500/20 border border-purple-500/20 text-void-text text-xs rounded-lg transition-colors flex items-center gap-2",title:"Install Agent using this connection string",children:[e.jsx(z,{className:"w-4 h-4"}),"Install"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-void-muted mb-1.5 uppercase tracking-wider",children:"SSH User"}),e.jsx("input",{type:"text",value:a.sshUser,onChange:i=>P("sshUser",i.target.value),className:"w-full px-3 py-2 bg-void-panel-2 border border-void-border rounded-lg text-void-text text-sm focus:outline-none focus:ring-1 focus:ring-purple-500/50",placeholder:"root"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-void-muted mb-1.5 uppercase tracking-wider",children:"SSH Port"}),e.jsx("input",{type:"number",value:a.sshPort,onChange:i=>P("sshPort",Number(i.target.value)),className:"w-full px-3 py-2 bg-void-panel-2 border border-void-border rounded-lg text-void-text text-sm focus:outline-none focus:ring-1 focus:ring-purple-500/50"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-void-muted mb-1.5 uppercase tracking-wider",children:"SSH Password (Optional)"}),e.jsx("input",{type:"password",value:a.sshPassword,onChange:i=>P("sshPassword",i.target.value),className:"w-full px-3 py-2 bg-void-panel-2 border border-void-border rounded-lg text-void-text text-sm focus:outline-none focus:ring-1 focus:ring-purple-500/50",placeholder:"••••••••"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-void-muted mb-1.5 uppercase tracking-wider",children:"Private Key (Optional)"}),e.jsx("textarea",{value:a.sshKey,onChange:i=>P("sshKey",i.target.value),className:"w-full px-3 py-2 bg-void-panel-2 border border-void-border rounded-lg text-void-text text-sm focus:outline-none focus:ring-1 focus:ring-purple-500/50 h-20 font-mono",placeholder:"-----BEGIN RSA PRIVATE KEY-----"})]})]})]})})]}),n==="bootstrap"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{type:"button",onClick:_,disabled:g,className:"w-full px-4 py-2 bg-white/5 hover:bg-white/10 border border-void-border text-void-text rounded-lg text-sm font-semibold transition-colors disabled:opacity-50",children:g?"Generating...":h?"Regenerate Join Code":"Generate Join Code"}),h&&e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"bg-void-panel-2 border border-void-border rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-void-muted mb-1",children:"Command"}),e.jsx("div",{className:"text-void-text font-mono text-[10px] break-all p-2 bg-black rounded",children:pe})]})})]}),F&&e.jsx("div",{className:"rounded-lg border border-red-500/20 bg-red-500/10 p-3 text-sm text-red-200 font-medium",children:F}),e.jsxs("div",{className:"pt-4 border-t border-void-border flex gap-3",children:[e.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-3 bg-white/5 hover:bg-white/10 border border-void-border text-void-text rounded-lg font-semibold transition-colors text-sm",children:"Cancel"}),n==="direct"&&a.connectionType==="ssh"&&e.jsxs("button",{type:"button",onClick:()=>{if(!a.ipAddress)return C("IP Required");c({...a,port:R})},className:"flex-1 px-4 py-3 bg-void-purple/15 hover:bg-void-purple/20 border border-void-purple/20 text-void-text rounded-lg font-semibold transition-colors text-sm flex items-center justify-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),"Connect & Install"]}),e.jsx("button",{type:"button",onClick:S,className:"flex-1 px-4 py-3 bg-white/10 hover:bg-white/20 border border-void-border text-void-text rounded-lg font-semibold transition-colors text-sm",children:n==="direct"?"Add Node":"Done"})]})]})]})})},mt=({node:r,onClose:b})=>{const[c,u]=s.useState([]),[a,p]=s.useState(!0);s.useEffect(()=>{n()},[r.id]);const n=async()=>{try{const l=await window.electronAPI.getNodeServers(r.id);u(l)}catch(l){console.error("Failed to fetch node servers:",l)}finally{p(!1)}},x=l=>l?new Date(l).toLocaleString():"Never";return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-void-panel border border-void-border rounded-xl w-full max-w-4xl max-h-[80vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-void-border flex items-center justify-between",children:[e.jsxs("h3",{className:"text-xl font-bold text-void-text",children:["Node Details - ",r.name]}),e.jsx("button",{onClick:b,className:"text-void-muted hover:text-void-text text-2xl",children:"×"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-bold text-void-text",children:"Connection Info"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-void-muted",children:"IP Address:"}),e.jsx("span",{className:"text-void-text",children:r.ip_address})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-void-muted",children:"Port:"}),e.jsx("span",{className:"text-void-text",children:r.port||3001})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-void-muted",children:"Status:"}),e.jsx("span",{className:`font-medium ${r.status==="online"?"text-purple-400":"text-void-muted"}`,children:r.status})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-void-muted",children:"Last Seen:"}),e.jsx("span",{className:"text-void-text",children:x(r.last_seen)})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-bold text-void-text",children:"System Resources"}),r.resources?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-void-muted",children:"CPU:"}),e.jsxs("span",{className:"text-void-text",children:[r.resources.cpu||"N/A","%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-void-muted",children:"Memory:"}),e.jsx("span",{className:"text-void-text",children:r.resources.memory||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-void-muted",children:"Disk:"}),e.jsx("span",{className:"text-void-text",children:r.resources.disk||"N/A"})]})]}):e.jsx("p",{className:"text-void-muted",children:"No resource data available"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-bold text-void-text mb-4",children:["Servers (",c.length,")"]}),a?e.jsx("p",{className:"text-void-muted",children:"Loading servers..."}):c.length===0?e.jsx("p",{className:"text-void-muted",children:"No servers assigned to this node"}):e.jsx("div",{className:"space-y-2",children:c.map(l=>e.jsx("div",{className:"bg-void-bg border border-void-border rounded-lg p-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-void-text font-medium",children:l.name}),e.jsxs("span",{className:"text-void-muted text-sm ml-2",children:["(",l.type,")"]})]}),e.jsx("div",{className:`px-2 py-1 rounded text-xs ${l.status==="running"?"bg-green-400/10 text-green-400":l.status==="stopped"?"bg-red-400/10 text-red-400":"bg-yellow-400/10 text-yellow-400"}`,children:l.status})]})},l.id))})]})]})]})})},ut=({status:r,onClose:b,onUpdate:c})=>{const[u,a]=s.useState(!1),[p,n]=s.useState(!1),x=async()=>{if(r?.nodeId){a(!0);try{const d=await window.electronAPI.startNodeTunnel(r.nodeId,r.localPort||3001);c(d)}catch(d){console.error("Failed to start tunnel:",d)}finally{a(!1)}}},l=async()=>{if(r?.nodeId){a(!0);try{const d=await window.electronAPI.stopNodeTunnel(r.nodeId);await new Promise(f=>setTimeout(f,1e3)),c({...r,active:!1,url:null,status:"stopped"})}catch(d){console.error("Failed to stop tunnel:",d)}finally{a(!1)}}},N=()=>{r?.url&&(navigator.clipboard.writeText(r.url),n(!0),setTimeout(()=>n(!1),2e3))};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-void-panel border border-void-border rounded-xl shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-void-text flex items-center gap-2",children:[e.jsx(ue,{className:"w-5 h-5 text-blue-400"}),"Remote Access Tunnel"]}),e.jsx("button",{onClick:b,className:"text-void-muted hover:text-void-text transition-colors",children:e.jsx(Q,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-void-panel-2 rounded-lg p-4 border border-void-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-void-muted",children:"Status"}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${r?.active?"bg-green-500/10 text-green-400 border border-green-500/20":"bg-void-bg text-void-muted border border-void-border"}`,children:r?.active?"Connected":"Disconnected"})]}),r?.url?e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"text-xs text-void-muted mb-1 block",children:"Public URL"}),e.jsxs("div",{className:"flex items-center gap-2 bg-void-bg border border-void-border rounded-md p-2",children:[e.jsx("code",{className:"text-sm text-blue-300 truncate flex-1",children:r.url}),e.jsx("button",{onClick:N,className:"p-1 hover:bg-void-panel-2 rounded text-void-muted hover:text-void-text transition-colors",title:"Copy URL",children:p?e.jsx(rt,{className:"w-4 h-4 text-green-400"}):e.jsx(ot,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-void-muted mt-2",children:"This URL allows access to your node from anywhere. It may change if the tunnel is restarted."})]}):e.jsx("p",{className:"text-sm text-void-muted mt-2",children:"Start a tunnel to make this node accessible from outside your local network."})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:b,className:"px-4 py-2 text-void-muted hover:text-void-text text-sm font-medium transition-colors",children:"Close"}),r?.active?e.jsx("button",{onClick:l,disabled:u,className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 border border-red-500/20 text-red-200 rounded-lg text-sm font-medium transition-colors disabled:opacity-50 flex items-center gap-2",children:u?"Stopping...":"Stop Tunnel"}):e.jsxs("button",{onClick:x,disabled:u,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-sm font-bold transition-colors disabled:opacity-50 flex items-center gap-2 shadow-lg shadow-blue-500/20",children:[e.jsx(ue,{className:"w-4 h-4"}),u?"Starting...":"Start Tunnel"]})]})]})]})})};export{yt as default};
