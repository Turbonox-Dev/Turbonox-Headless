import{j as e}from"./markdown-Bat84yML.js";import{r,e as R,X as I,a3 as q,A as Y,a2 as B,O as X,v as Q,w as W,a4 as F}from"./lucide-Bfyd0ICn.js";import{V as N}from"./VoidDropdown-C1MOWfVa.js";import{R as Z}from"./RestrictedView-Cn5sOcE9.js";import"./react-vendor-N--QU9DW.js";const oe=({cloudUser:d})=>{const[p,L]=r.useState(null),[ee,$]=r.useState(null),[f,U]=r.useState([]),[v,_]=r.useState([]),[h,G]=r.useState(""),[o,k]=r.useState("ngrok"),[i,x]=r.useState(!1),[u,g]=r.useState(!1),[A,y]=r.useState(""),[b,C]=r.useState({}),[E,S]=r.useState(""),[j,V]=r.useState(""),[D,l]=r.useState(null),[T,n]=r.useState(null),M=r.useMemo(()=>{if(!d)return!1;if(d.is_restricted)return!0;try{const t=typeof d.restricted_features=="string"?JSON.parse(d.restricted_features):d.restricted_features;if(Array.isArray(t)&&t.includes("manage_network"))return!0}catch{}return!1},[d]);r.useEffect(()=>{m(),P(),O();const t=setInterval(m,5e3);return()=>clearInterval(t)},[]),r.useEffect(()=>{const t=()=>{m(),P(),O()};return window.addEventListener("void-active-account-changed",t),()=>{window.removeEventListener("void-active-account-changed",t)}},[]);const m=async()=>{try{const t=window.electronAPI?.config?.backendPort||"3456",[s,a,c]=await Promise.all([window.electronAPI.getNetworkStatus(),window.electronAPI.getTunnelConfig(),fetch(`http://localhost:${t}/api/network/tunnels`).then(w=>w.json())]);L(s),$(a),U(Array.isArray(c?.tunnels)?c.tunnels:[])}catch(t){console.error("Failed to fetch network data:",t)}},P=async()=>{try{const t=await window.electronAPI.getServers();_(t.filter(s=>s.status==="running"))}catch(t){console.error("Failed to fetch servers:",t)}},O=async()=>{const t=window.electronAPI?.config?.backendPort||"3456";try{const s=await Promise.all([fetch(`http://localhost:${t}/api/network/tunnel/config/ngrok`).then(a=>a.json()),fetch(`http://localhost:${t}/api/network/tunnel/config/cloudflare`).then(a=>a.json()),fetch(`http://localhost:${t}/api/network/cache-directory`).then(a=>a.json())]);C({ngrok:s[0]?.authtoken||"",cloudflare:s[1]?.authtoken||""}),s[2]?.cacheDirectory&&S(s[2].cacheDirectory),s[2]?.defaultCacheDirectory&&V(s[2].defaultCacheDirectory)}catch(s){console.error("Failed to load saved config:",s)}},K=async()=>{x(!0),l(null),n(null);const t=window.electronAPI?.config?.backendPort||"3456";try{if(!(await fetch(`http://localhost:${t}/api/network/tunnel/config`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:o,authtoken:A})})).ok)throw new Error("Failed to save configuration");const a=await fetch(`http://localhost:${t}/api/network/cache-directory`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({directoryPath:E})}),c=await a.json();if(!a.ok||c.error)throw new Error(c.error||"Failed to update cache directory");n("Configuration saved successfully!"),C(w=>({...w,[o]:A})),setTimeout(()=>{g(!1),n(null)},2e3)}catch(s){console.error("Failed to save config:",s),l(s.message||"Failed to save configuration")}finally{x(!1)}},z=async()=>{if(!h){l("Please select a running server");return}x(!0),l(null),n(null);const t=window.electronAPI?.config?.backendPort||"3456";try{const s=await fetch(`http://localhost:${t}/api/network/tunnels/start`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({serverId:h,provider:o,authtoken:b[o]||void 0})}),a=await s.json();if(!s.ok)throw new Error(a.details||a.error||"Failed to start tunnel");n(`Tunnel started! URL: ${a.url}`),m()}catch(s){console.error("Failed to start tunnel:",s),l(s.message)}finally{x(!1)}},J=async t=>{x(!0),l(null),n(null);const s=window.electronAPI?.config?.backendPort||"3456";try{if(t){const a=await fetch(`http://localhost:${s}/api/network/tunnels/${t}/stop`,{method:"POST"}),c=await a.json().catch(()=>({}));if(!a.ok)throw new Error(c.error||"Failed to stop tunnel")}else await window.electronAPI.stopTunnel();n("Tunnel stopped successfully"),m()}catch(a){console.error("Failed to stop tunnel:",a),l(a.message||"Failed to stop tunnel")}finally{x(!1)}},H=t=>{navigator.clipboard.writeText(t),n("URL copied to clipboard!"),setTimeout(()=>n(null),2e3)};return M?e.jsx(Z,{title:"Network Access Restricted",description:"Public access and tunnel management features have been restricted for your account."}):e.jsxs("div",{className:"min-h-screen bg-black text-white p-8 font-sans selection:bg-purple-500/30",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 mb-12 border-b border-[#1A1A1A] pb-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-2 h-2 bg-[#7C3AED]"}),e.jsx("span",{className:"text-[10px] font-mono tracking-[0.3em] text-[#A1A1AA] uppercase",children:"System / Network"})]}),e.jsx("h2",{className:"text-4xl font-medium tracking-tight text-white m-0",children:"Network Controller"}),e.jsx("p",{className:"text-[#A1A1AA] mt-2 font-mono text-xs tracking-wider",children:"Manage secure tunnels and global ingress protocols"})]}),e.jsxs("button",{onClick:()=>g(!u),className:`flex items-center gap-2 px-6 py-2 border transition-all duration-150 linear font-mono text-[11px] tracking-widest uppercase ${u?"bg-[#7C3AED] border-[#7C3AED] text-white":"bg-black border-[#1A1A1A] text-[#A1A1AA] hover:border-[#7C3AED] hover:text-white"}`,children:[e.jsx(R,{className:"w-4 h-4"}),u?"Close Config":"Configure"]})]}),D&&e.jsxs("div",{className:"mb-8 border border-[#1A1A1A] bg-black p-4 flex items-start gap-4 animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsx("div",{className:"mt-1 w-1.5 h-1.5 rounded-full bg-red-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] font-mono tracking-widest text-red-500 uppercase mb-1",children:"Critical Error"}),e.jsx("p",{className:"text-sm text-white font-mono",children:D})]}),e.jsx("button",{onClick:()=>l(null),className:"text-[#A1A1AA] hover:text-white transition-colors",children:e.jsx(I,{className:"w-4 h-4"})})]}),T&&e.jsxs("div",{className:"mb-8 border border-[#1A1A1A] bg-black p-4 flex items-start gap-4 animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsx("div",{className:"mt-1 w-1.5 h-1.5 rounded-full bg-[#7C3AED]"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] font-mono tracking-widest text-[#7C3AED] uppercase mb-1",children:"Status Update"}),e.jsx("p",{className:"text-sm text-white font-mono",children:T})]}),e.jsx("button",{onClick:()=>n(null),className:"text-[#A1A1AA] hover:text-white transition-colors",children:e.jsx(I,{className:"w-4 h-4"})})]}),u&&e.jsxs("div",{className:"mb-12 border border-[#1A1A1A] bg-black p-8 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-5 pointer-events-none",children:e.jsx(R,{className:"w-32 h-32"})}),e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx(q,{className:"w-4 h-4 text-[#7C3AED]"}),e.jsx("h3",{className:"text-sm font-mono tracking-[0.2em] text-white uppercase",children:"Configuration Matrix"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-mono tracking-widest text-[#A1A1AA] uppercase mb-3",children:"Tunnel Protocol"}),e.jsx(N,{value:o,options:[{value:"ngrok",label:"NGROK EDGE"},{value:"cloudflare",label:"CLOUDFLARE T-7"}],onChange:t=>{k(String(t)),y(b[String(t)]||"")},disabled:i,className:"w-full font-mono text-xs uppercase"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-mono tracking-widest text-[#A1A1AA] uppercase mb-3 flex justify-between",children:[e.jsx("span",{children:"Authentication Token"}),b[o]&&e.jsx("span",{className:"text-[#7C3AED]",children:"[ENCRYPTED]"})]}),e.jsx("input",{type:"password",value:A,onChange:t=>y(t.target.value),placeholder:o==="ngrok"?"NGROK_AUTH_TOKEN":"CLOUDFLARE_ACCESS_SECRET",className:"w-full px-4 py-3 bg-black border border-[#1A1A1A] text-white font-mono text-sm placeholder:text-[#333] focus:outline-none focus:border-[#7C3AED]"}),e.jsx("p",{className:"text-[9px] font-mono text-[#555] mt-2 leading-relaxed uppercase tracking-wider",children:o==="ngrok"?e.jsxs(e.Fragment,{children:["Credential managed via ",e.jsx("a",{href:"https://dashboard.ngrok.com",target:"_blank",rel:"noopener noreferrer",className:"text-[#7C3AED] underline-offset-2",children:"ngrok.com"})]}):e.jsx(e.Fragment,{children:"Transient mode enabled by default. Provide token for persistent routing."})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-mono tracking-widest text-[#A1A1AA] uppercase mb-3 text-right md:text-left",children:"Binary Storage Node"}),e.jsx("input",{type:"text",value:E,onChange:t=>S(t.target.value),placeholder:j||"/usr/local/bin/void-cache",className:"w-full px-4 py-3 bg-black border border-[#1A1A1A] text-white font-mono text-sm placeholder:text-[#333] focus:outline-none focus:border-[#7C3AED]"}),e.jsx("p",{className:"text-[9px] font-mono text-[#555] mt-2 uppercase tracking-wider",children:j?`ROOT: ${j}`:"AUTO-DETECTION MODE ACTIVE"})]}),e.jsxs("div",{className:"flex gap-4 pt-1",children:[e.jsx("button",{onClick:K,disabled:i,className:"flex-1 bg-[#7C3AED] text-white py-3 px-6 font-mono text-[11px] tracking-widest uppercase disabled:opacity-50",children:i?"Committing...":"Commit Changes"}),e.jsx("button",{onClick:()=>g(!1),className:"px-6 py-3 border border-[#1A1A1A] text-white font-mono text-[11px] tracking-widest uppercase",children:"Abort"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-0 border border-[#1A1A1A] mb-12",children:[e.jsxs("div",{className:"p-8 border-b md:border-b-0 md:border-r border-[#1A1A1A] group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-[10px] font-mono tracking-widest text-[#A1A1AA] uppercase",children:"Node Status / Ingress"}),e.jsx("div",{className:`w-1.5 h-1.5 ${p?.tunnelActive?"bg-[#7C3AED]":"bg-[#333]"}`})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("p",{className:"text-3xl font-mono text-white uppercase tracking-tight",children:p?.tunnelActive?"Online":"Standby"}),e.jsx("span",{className:"text-[10px] font-mono text-[#555] uppercase",children:p?.provider||"None"})]})]}),e.jsxs("div",{className:"p-8 border-b md:border-b-0 md:border-r border-[#1A1A1A]",children:[e.jsx("div",{className:"text-[10px] font-mono tracking-widest text-[#A1A1AA] uppercase mb-4",children:"Core Identifier / IPV4"}),e.jsx("p",{className:"text-3xl font-mono text-white tracking-widest",children:p?.publicIp||"0.0.0.0"})]}),e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"text-[10px] font-mono tracking-widest text-[#A1A1AA] uppercase mb-4",children:"Active Uplinks / Streams"}),e.jsx("p",{className:"text-3xl font-mono text-white",children:String(p?.activeConnections||0).padStart(2,"0")})]})]}),e.jsxs("div",{className:"border border-[#1A1A1A] bg-black overflow-hidden mb-12",children:[e.jsxs("div",{className:"bg-black border-b border-[#1A1A1A] px-8 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Y,{className:"w-4 h-4 text-[#7C3AED]"}),e.jsx("h3",{className:"text-xs font-mono tracking-[0.2em] text-white uppercase",children:"Uplink Controller"})]}),f.length>0&&e.jsx("span",{className:"text-[10px] font-mono text-[#7C3AED] uppercase tracking-widest",children:"Live Routing Active"})]}),e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"space-y-6",children:[f.length>0&&e.jsx("div",{className:"grid grid-cols-1 gap-4 mb-8",children:f.map(t=>e.jsx("div",{className:"p-6 border border-[#1A1A1A] bg-black relative group hover:border-[#7C3AED]/30 transition-colors duration-150 linear",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"mt-1 flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-[#7C3AED]"}),e.jsx("div",{className:"w-[1px] h-8 bg-[#1A1A1A]"})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-[10px] font-mono tracking-widest text-[#A1A1AA] uppercase mb-1",children:["Active Route / ",t.provider]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"text",value:t.url,readOnly:!0,className:"bg-transparent text-white font-mono text-sm focus:outline-none min-w-[300px]"}),e.jsx("button",{onClick:()=>H(t.url),className:"text-[#555] hover:text-[#7C3AED] transition-colors",title:"Copy Endpoint",children:e.jsx(B,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"mt-2 flex gap-4 text-[9px] font-mono text-[#555] uppercase tracking-tighter",children:[e.jsxs("span",{children:["Port: ",t.port]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["ID: ",t.id]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["SRV: ",t.serverId]})]})]})]}),e.jsx("button",{onClick:()=>J(t.id),disabled:i,className:"px-6 py-2 border border-red-900/50 hover:bg-red-950/20 text-red-500 font-mono text-[10px] tracking-widest uppercase transition-all",children:"Terminate Link"})]})},t.id))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 py-4 border-t border-[#1A1A1A]",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-mono tracking-widest text-[#A1A1AA] uppercase mb-3",children:"Routing Protocol"}),e.jsx(N,{value:o,options:[{value:"ngrok",label:"NGROK EDGE"},{value:"cloudflare",label:"CLOUDFLARE T-7"}],onChange:t=>k(String(t)),disabled:i,className:"w-full font-mono text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-mono tracking-widest text-[#A1A1AA] uppercase mb-3",children:"Node Selection"}),e.jsx(N,{value:String(h||""),options:[{value:"",label:"Select Virtual instance..."},...v.map(t=>({value:String(t.id),label:`${t.name.toUpperCase()} / PORT:${t.port||"AUTO"}`}))],onChange:t=>G(String(t||"")),disabled:i,className:"w-full font-mono text-xs"}),v.length===0&&e.jsxs("p",{className:"text-[9px] font-mono text-red-500 mt-2 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(X,{className:"w-3 h-3"})," Initialization Failed: No Active Nodes Found"]})]})]}),e.jsx("button",{onClick:z,disabled:i||!h,className:"w-full py-4 bg-white hover:bg-gray-200 text-black font-mono text-[11px] tracking-[0.4em] uppercase transition-all duration-150 linear disabled:opacity-20 disabled:cursor-not-allowed border-none flex items-center justify-center gap-3",children:i?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4 animate-spin"})," Establishing Data Link..."]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"w-4 h-4 fill-current"})," Initialize Tunnel"]})})]})})]}),e.jsxs("div",{className:"border border-[#1A1A1A] bg-black p-8 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute -right-8 -bottom-8 opacity-[0.03] rotate-12 group-hover:rotate-0 transition-transform duration-700",children:e.jsx(F,{className:"w-64 h-64"})}),e.jsxs("div",{className:"flex items-start gap-6 relative z-10",children:[e.jsx("div",{className:"w-10 h-10 border border-[#1A1A1A] flex items-center justify-center flex-shrink-0",children:e.jsx(F,{className:"w-5 h-5 text-[#7C3AED]"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-mono tracking-[0.2em] text-white uppercase mb-6",children:"Documentation / Protocol Specs"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[10px] font-mono text-[#7C3AED] uppercase tracking-widest",children:"01 / NGROK EDGE"}),e.jsxs("p",{className:"text-[11px] text-[#A1A1AA] leading-relaxed uppercase",children:["Acquire HMAC token from ",e.jsx("a",{href:"https://ngrok.com",target:"_blank",rel:"noopener noreferrer",className:"text-white hover:text-[#7C3AED] underline transition-colors",children:"NGROK.COM"}),". Map to local port for global ingress."]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[10px] font-mono text-[#7C3AED] uppercase tracking-widest",children:"02 / CLOUDFLARE T-7"}),e.jsxs("p",{className:"text-[11px] text-[#A1A1AA] leading-relaxed uppercase",children:["Utilize TryCloudflare for ephemeral routing or install ",e.jsx("span",{className:"text-white",children:"CLOUDFLARED"})," for persistent tunnel nodes."]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[10px] font-mono text-[#7C3AED] uppercase tracking-widest",children:"03 / NODE MATCHING"}),e.jsxs("p",{className:"text-[11px] text-[#A1A1AA] leading-relaxed uppercase",children:["Tunnels require an active Virtual Instance. Ensure node status is ",e.jsx("span",{className:"text-white",children:"RUNNING"})," before link initialization."]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[10px] font-mono text-[#7C3AED] uppercase tracking-widest",children:"04 / DATA PRIVACY"}),e.jsx("p",{className:"text-[11px] text-[#A1A1AA] leading-relaxed uppercase",children:"All tunnel traffic is encrypted at the edge. Proxied URLs remain active until terminal de-initialization."})]})]})]})]})]})]})]})};export{oe as default};
