import{j as e}from"./markdown-Bat84yML.js";import{r as c,m as w,O as j,j as f,k as N,d as h,z as y,l as b}from"./lucide-Bfyd0ICn.js";import"./react-vendor-N--QU9DW.js";const C=({currentUser:a})=>{const[l,p]=c.useState({name:a?.name||"",email:a?.email||"",role:a?.role||"user"}),[t,m]=c.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[x,d]=c.useState(!1),[u,r]=c.useState(null);c.useEffect(()=>{a&&p(s=>({...s,name:a.name||"",email:a.email||"",role:a.role||"user"}))},[a]);const v=async s=>{s.preventDefault(),d(!0),r(null);try{const o=localStorage.getItem("turbonox_token"),i=await fetch("/api/auth/me",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({name:l.name,email:l.email})}),n=await i.json();if(!i.ok)throw new Error(n.error||"Failed to update profile");r({type:"success",text:"Profile updated successfully"}),n.token&&localStorage.setItem("turbonox_token",n.token)}catch(o){r({type:"error",text:o.message})}finally{d(!1)}},g=async s=>{if(s.preventDefault(),d(!0),r(null),t.newPassword.length<8){r({type:"error",text:"New password must be at least 8 characters"}),d(!1);return}if(t.newPassword!==t.confirmPassword){r({type:"error",text:"New passwords do not match"}),d(!1);return}try{const o=localStorage.getItem("turbonox_token"),i=await fetch("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({currentPassword:t.currentPassword,newPassword:t.newPassword})}),n=await i.json();if(!i.ok)throw new Error(n.error||"Failed to change password");r({type:"success",text:"Password changed successfully"}),m({currentPassword:"",newPassword:"",confirmPassword:""})}catch(o){r({type:"error",text:o.message})}finally{d(!1)}};return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-void-border pb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-void-text tracking-tight",children:"My Profile"}),e.jsx("p",{className:"text-void-muted mt-2 font-mono text-sm",children:"Manage your account settings and security."})]}),e.jsxs("div",{className:"px-4 py-2 bg-void-panel border border-void-border rounded-lg flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${a?.role==="admin"?"bg-purple-500 shadow-[0_0_8px_rgba(168,85,247,0.4)]":"bg-emerald-500"}`}),e.jsx("span",{className:"text-xs font-mono uppercase tracking-widest text-void-muted",children:a?.role==="admin"?"Administrator":"User Account"})]})]}),u&&e.jsxs("div",{className:`p-4 rounded-lg border flex items-center gap-3 ${u.type==="success"?"bg-emerald-950/30 border-emerald-900/50 text-emerald-400":"bg-red-950/30 border-red-900/50 text-red-400"}`,children:[u.type==="success"?e.jsx(w,{className:"w-5 h-5"}):e.jsx(j,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:u.text})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-void-panel border border-void-border rounded-xl p-6 h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6 text-void-text font-semibold",children:[e.jsx(f,{className:"w-5 h-5 text-void-cyan"}),e.jsx("h3",{children:"Personal Information"})]}),e.jsxs("form",{onSubmit:v,className:"space-y-4 flex-1",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-mono uppercase text-void-muted tracking-wider",children:"Display Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:l.name,onChange:s=>p({...l,name:s.target.value}),className:"w-full bg-void-bg border border-void-border rounded-lg px-4 py-2.5 text-sm text-void-text focus:border-void-cyan/50 focus:ring-1 focus:ring-void-cyan/20 outline-none transition-all pl-10",placeholder:"Your Name"}),e.jsx(f,{className:"w-4 h-4 text-void-muted absolute left-3 top-3"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-mono uppercase text-void-muted tracking-wider",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"email",value:l.email,onChange:s=>p({...l,email:s.target.value}),className:"w-full bg-void-bg border border-void-border rounded-lg px-4 py-2.5 text-sm text-void-text focus:border-void-cyan/50 focus:ring-1 focus:ring-void-cyan/20 outline-none transition-all pl-10",placeholder:"name@example.com"}),e.jsx(N,{className:"w-4 h-4 text-void-muted absolute left-3 top-3"})]})]}),e.jsx("div",{className:"pt-4 mt-auto",children:e.jsxs("button",{type:"submit",disabled:x,className:"w-full bg-void-text hover:bg-white text-black font-bold py-2.5 rounded-lg transition-colors flex items-center justify-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[x?e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):e.jsx(h,{className:"w-4 h-4"}),"SAVE CHANGES"]})})]})]}),e.jsxs("div",{className:"bg-void-panel border border-void-border rounded-xl p-6 h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6 text-void-text font-semibold",children:[e.jsx(y,{className:"w-5 h-5 text-purple-400"}),e.jsx("h3",{children:"Security"})]}),e.jsxs("form",{onSubmit:g,className:"space-y-4 flex-1",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-mono uppercase text-void-muted tracking-wider",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"password",value:t.currentPassword,onChange:s=>m({...t,currentPassword:s.target.value}),className:"w-full bg-void-bg border border-void-border rounded-lg px-4 py-2.5 text-sm text-void-text focus:border-purple-500/50 focus:ring-1 focus:ring-purple-500/20 outline-none transition-all pl-10",placeholder:"••••••••"}),e.jsx(b,{className:"w-4 h-4 text-void-muted absolute left-3 top-3"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-mono uppercase text-void-muted tracking-wider",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"password",value:t.newPassword,onChange:s=>m({...t,newPassword:s.target.value}),className:"w-full bg-void-bg border border-void-border rounded-lg px-4 py-2.5 text-sm text-void-text focus:border-purple-500/50 focus:ring-1 focus:ring-purple-500/20 outline-none transition-all pl-10",placeholder:"Min. 8 characters"}),e.jsx(b,{className:"w-4 h-4 text-void-muted absolute left-3 top-3"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-mono uppercase text-void-muted tracking-wider",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"password",value:t.confirmPassword,onChange:s=>m({...t,confirmPassword:s.target.value}),className:"w-full bg-void-bg border border-void-border rounded-lg px-4 py-2.5 text-sm text-void-text focus:border-purple-500/50 focus:ring-1 focus:ring-purple-500/20 outline-none transition-all pl-10",placeholder:"Repeat new password"}),e.jsx(b,{className:"w-4 h-4 text-void-muted absolute left-3 top-3"})]})]}),e.jsx("div",{className:"pt-4 mt-auto",children:e.jsxs("button",{type:"submit",disabled:x,className:"w-full bg-void-panel-2 hover:bg-void-border border border-void-border text-void-text font-bold py-2.5 rounded-lg transition-colors flex items-center justify-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[x?e.jsx("div",{className:"w-4 h-4 border-2 border-void-text border-t-transparent rounded-full animate-spin"}):e.jsx(h,{className:"w-4 h-4"}),"UPDATE PASSWORD"]})})]})]})]})]})};export{C as default};
